<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Rupert — Interactive Children’s Book</title>
<meta name="color-scheme" content="light only" />
<link rel="icon" href="images/favicon.png" type="image/png" />
<link rel="apple-touch-icon" href="images/favicon.png" />
<meta name="theme-color" content="#f4ca44" />
<meta property="og:title" content="Rupert — Interactive Children’s Book" />
<meta property="og:description" content="A premium, narrated, interactive children’s book experience featuring Rupert and friends." />
<meta property="og:image" content="https://kj125-sudo.github.io/Rupert-The-Dog-Interactive-Book/images/Cover-Page.png" />
<meta property="og:image:width" content="1000" />
<meta property="og:image:height" content="800" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://kj125-sudo.github.io/Rupert-The-Dog-Interactive-Book/" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:title" content="Rupert — Interactive Children’s Book" />
<meta name="twitter:description" content="A premium, narrated, interactive children’s book experience featuring Rupert and friends." />
<meta name="twitter:image" content="https://kj125-sudo.github.io/Rupert-The-Dog-Interactive-Book/images/Cover-Page.png" />

<style>
:root{
  --brand1:#f4ca44; --brand2:#59b379;
  --bg:#f7f7f9; --ink:#1c1d21; --muted:#6b7280;
  --card:#fff; --shadow:0 10px 30px rgba(0,0,0,.08); --r:18px;
}
*{box-sizing:border-box} html,body{height:100%}
body{margin:0;background:var(--bg);color:var(--ink);font:16px/1.5 system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;display:grid;place-items:center}
.app{width:min(980px,100%);padding:16px}
.card{background:var(--card);border-radius:var(--r);box-shadow:var(--shadow);padding:24px}
h1{margin:0 0 12px;font-size:clamp(20px,2.6vw,28px)}
.hint{color:var(--muted);margin-top:8px}
.logo{height:48px}.logo.small{height:28px}
.cover{display:grid;gap:16px}
.cover-head{display:flex;justify-content:center}
.cover-art{display:grid;place-items:center}
.cover-img{width:100%;height:auto;max-width:900px;aspect-ratio:5/4;object-fit:contain;border-radius:12px;background:#fff}
.cover-actions{text-align:center}
.buttons{display:flex;gap:12px;justify-content:center;flex-wrap:wrap}
.btn{appearance:none;border:none;cursor:pointer;padding:12px 18px;border-radius:12px;font-weight:700;box-shadow:var(--shadow);background:#fff;color:var(--ink);border:2px solid transparent}
.btn:hover{filter:brightness(1.05)} .btn:active{transform:translateY(1px)}
.btn-outline{border-color:var(--brand2);color:var(--brand2);background:#fff}
.btn-brand{background:linear-gradient(90deg,var(--brand1),var(--brand2));color:#111}
.btn.pill{border-radius:999px;padding:8px 14px}
.reader .topbar,.reader .bottombar{display:flex;align-items:center;justify-content:space-between;gap:12px;margin:10px 0}
.left{display:flex;align-items:center;gap:10px}
.progress{font-weight:700}
.progressbar{height:6px;background:#e9eef6;border-radius:999px;overflow:hidden;margin-bottom:8px}
.bar{height:100%;width:0;background:linear-gradient(90deg,var(--brand1),var(--brand2))}
.page-wrap{position:relative;background:var(--card);border-radius:var(--r);box-shadow:var(--shadow);padding:clamp(8px,1.5vw,14px);display:grid;place-items:center;min-height:min(80vh,80dvh)}
#page-img{width:100%;height:auto;max-width:900px;aspect-ratio:5/4;object-fit:contain;border-radius:10px;background:#fff}
.fade{opacity:0;transition:opacity .28s ease} .fade.show{opacity:1}
.nav{position:absolute;top:50%;transform:translateY(-50%);width:clamp(36px,6vw,56px);height:clamp(36px,6vw,56px);border-radius:50%;border:none;cursor:pointer;background:rgba(0,0,0,.06);color:#111;font-size:clamp(20px,4vw,28px);font-weight:700;display:grid;place-items:center}
.nav:hover{background:rgba(0,0,0,.1)} .nav.prev{left:8px}.nav.next{right:8px}
@media (max-width:520px){.nav{display:none}}
.hidden{display:none}
</style>
</head>
<body>
<main class="app">
  <!-- COVER -->
  <section id="cover" class="card cover">
    <div class="cover-head">
      <img src="images/logo.png" alt="" class="logo" onerror="this.style.display='none'">
    </div>
    <div class="cover-art">
      <img src="images/Cover-Page.png" alt="Cover page" class="cover-img">
    </div>
    <div class="cover-actions">
      <h1>How would you like to read?</h1>
      <div class="buttons">
        <button id="start-auto" class="btn btn-brand">Auto (narrated)</button>
        <button id="start-manual" class="btn btn-outline">Read it myself</button>
      </div>
      <p class="hint">Audio starts after you click (browser policy).</p>
    </div>
  </section>

  <!-- READER -->
  <section id="reader" class="reader hidden">
    <div class="progressbar"><div id="bar" class="bar"></div></div>

    <header class="topbar">
      <div class="left">
        <img src="images/logo.png" alt="" class="logo small" onerror="this.style.display='none'">
        <div class="progress">Page <span id="page-num">1</span>/<span id="page-total">--</span></div>
      </div>
      <div class="controls">
        <button id="mode-toggle" class="btn pill">Switch to Manual</button>
        <button id="mute-toggle" class="btn pill">Mute</button>
      </div>
    </header>

    <div class="page-wrap">
      <button id="prev" class="nav prev" aria-label="Previous page">‹</button>
      <img id="page-img" alt="Book page" class="fade" />
      <button id="next" class="nav next" aria-label="Next page">›</button>
    </div>

    <footer class="bottombar">
      <div class="left"><button id="restart" class="btn pill">Restart</button></div>
      <div class="right"><button id="playpause" class="btn pill">Play</button></div>
    </footer>

    <audio id="narration" preload="auto"></audio>
  </section>
</main>

<script>
/* ===== CONFIG (edit these) ===== */
const TOTAL_PAGES = 67;               // how many page images & audio files
const IMAGE_DIR = 'images';
const AUDIO_DIR = 'audio';
const FILE_PREFIX = 'Page-';          // capital P for BOTH images & audio
const IMAGE_EXT = 'png';
const AUDIO_EXT = 'mp3';

/* ===== Helpers ===== */
const $ = s => document.querySelector(s);
const imgSrc   = n => `${IMAGE_DIR}/${FILE_PREFIX}${n}.${IMAGE_EXT}`;
const audioSrc = n => `${AUDIO_DIR}/${FILE_PREFIX}${n}.${AUDIO_EXT}`;

/* ===== State & Elements ===== */
let mode = 'manual', page = 1, muted = false, touchStartX = 0;
const elCover = $('#cover'), elReader = $('#reader'), elImg = $('#page-img'), elAudio = $('#narration');
const elPageNum = $('#page-num'), elPageTotal = $('#page-total'), elBar = $('#bar');
const btnStartAuto = $('#start-auto'), btnStartManual = $('#start-manual');
const btnPrev = $('#prev'), btnNext = $('#next'), btnRestart = $('#restart');
const btnMode = $('#mode-toggle'), btnMute = $('#mute-toggle'), btnPlayPause = $('#playpause');

elPageTotal.textContent = TOTAL_PAGES;

/* Preload cover + first few (non-blocking) */
(function preload(){
  const list = [imgSrc(1), 'images/Cover-Page.png'];
  for (let i=2; i<=Math.min(5, TOTAL_PAGES); i++) list.push(imgSrc(i));
  list.forEach(src => { const im=new Image(); im.src=src; });
})();

function setProgress(n){
  const pct = Math.max(0, Math.min(100, (n-1)/(TOTAL_PAGES-1)*100));
  elBar.style.width = `${pct}%`;
}
function fadeIn(){ elImg.classList.remove('show'); requestAnimationFrame(()=>requestAnimationFrame(()=>elImg.classList.add('show'))); }

function loadPage(n, opts={ play:false }){
  page = Math.max(1, Math.min(TOTAL_PAGES, n));
  elPageNum.textContent = page; setProgress(page);

  elImg.onload = () => fadeIn();
  elImg.onerror = () => console.warn(`Missing image Page ${page}: ${imgSrc(page)}`);
  elImg.src = imgSrc(page);

  elAudio.src = audioSrc(page);
  elAudio.load();
  elAudio.muted = muted;

  // warm-preload next image
  if (page < TOTAL_PAGES) { const im=new Image(); im.src = imgSrc(page+1); }

  if (opts.play) elAudio.play().catch(()=>{ /* needs user gesture or missing audio */ });
}

function nextPage(opts={ play: mode==='auto' }){ if (page < TOTAL_PAGES) loadPage(page+1, opts); else if (mode==='auto') btnPlayPause.textContent='Play'; }
function prevPage(opts={ play:false }){ if (page > 1) loadPage(page-1, opts); }

function setMode(next){
  mode = next;
  btnMode.textContent = mode==='auto' ? 'Switch to Manual' : 'Switch to Auto';
  btnPlayPause.textContent = mode==='auto' ? 'Pause' : 'Play';
}
function startReader(initialMode){
  setMode(initialMode);
  elCover.classList.add('hidden');
  elReader.classList.remove('hidden');
  loadPage(1, { play: initialMode==='auto' });
}

/* ===== Events ===== */
btnStartAuto.addEventListener('click', ()=> startReader('auto'));
btnStartManual.addEventListener('click', ()=> startReader('manual'));
btnNext.addEventListener('click', ()=> nextPage({ play: mode==='auto' }));
btnPrev.addEventListener('click', ()=> prevPage({ play: mode==='auto' }));
btnRestart.addEventListener('click', ()=> loadPage(1, { play: mode==='auto' }));
btnMode.addEventListener('click', ()=>{
  const m = mode==='auto' ? 'manual' : 'auto';
  setMode(m);
  if (m==='auto') elAudio.play().catch(()=>{}); else elAudio.pause();
});
btnMute.addEventListener('click', ()=>{
  muted = !muted; elAudio.muted = muted;
  btnMute.textContent = muted ? 'Unmute' : 'Mute';
});
btnPlayPause.addEventListener('click', ()=>{
  if (elAudio.paused){ elAudio.play().then(()=> btnPlayPause.textContent='Pause').catch(()=>{}); }
  else { elAudio.pause(); btnPlayPause.textContent='Play'; }
});
elAudio.addEventListener('ended', ()=> { if (mode==='auto') nextPage({ play:true }); });

// keyboard + tap + swipe
window.addEventListener('keydown', e=>{
  if (elReader.classList.contains('hidden')) return;
  if (e.key==='ArrowRight') nextPage({ play: mode==='auto' });
  if (e.key==='ArrowLeft')  prevPage({ play: mode==='auto' });
});
elImg.addEventListener('click', ()=> nextPage({ play: mode==='auto' }));
elImg.addEventListener('touchstart', e=> { touchStartX = e.changedTouches[0].clientX; }, {passive:true});
elImg.addEventListener('touchend', e=>{
  const dx = e.changedTouches[0].clientX - touchStartX, T=50;
  if (dx >  T) prevPage({ play: mode==='auto' });
  if (dx < -T) nextPage({ play: mode==='auto' });
}, {passive:true});
</script>
</body>
</html>
